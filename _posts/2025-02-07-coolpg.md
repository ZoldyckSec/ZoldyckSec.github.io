---
title: Coolpg - HackMyVM WriteUp
description: PostgreSQL Injection & EnumeraciÃ³n de Privilegios
author: ZoldyckSec
date: 2025-02-07 00:00:00 +0800
categories: [CTF Practice, HackMyVM]               
tags: [Coolpg, Linux, CTF,]  
render_with_liquid: false
---

## Description:

- `Date` Feb 07, 2025
- `Machine` Coolpg (Linux)
- `Difficulty` Easy
- `Prepared by` Allan Espinoza(Aka.ZoldyckSec)

## RESUMEN

Coolpg is a Linux machine that exposes a web service vulnerable to SQL Injection within a PostgreSQL database. The exploitation path requires enumerating database privileges to rule out direct RCE, opting for credential exfiltration, and finally escalating privileges by abusing a misconfigured SUID/Sudo binary.

## Reconnaissance

#### Port Scanning

```bash
nmap -p- --open -sS --min-rate 5555 -vvv -n -Pn -oG allPorts 192.168.1.70
```
The scan reveals two open ports:

- Port 22: SSH
- Port 80: HTTP 

#### Service And Versions 

```bash
nmap -p22,80 -sCV -oN targeted 192.168.1.70
```
```markdown
 PORT   STATE SERVICE VERSION
 22/tcp open  ssh     OpenSSH 10.0p2 Debian 7 (protocol 2.0)
 80/tcp open  http    nginx
 |_http-title: CoolPG Internal
```

#### Web Application Analysis

Web application on port 80 reveals a login interface:

![Desktop View](/assets/img/Coolpg/webpanel.png){: width="972" height="589" }
_Full screen width and center alignment_

- Footer Domain: coolpgi.hmv

#### Domain successfully verified

```bash
 curl -I http://coolpgi.hmv/
HTTP/1.1 200 OK
Server: nginx
Date: Mon, 09 Feb 2026 07:03:10 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 1323
Connection: keep-alive
```

#### Technologies identified

```markdown
 whatweb http://coolpgi.hmv/
http://coolpgi.hmv/ [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[nginx], IP[192.168.1.70], PasswordField[password], Title[CoolPG Internal], nginx
```

> Programming languages: `PHP` (Identified by Wappalyzer). 

#### Web Enumeration

Once the domain has been verified, we list.

```bash
ffuf -c -ic -fc 403 -v -u http://coolpgi.hmv/FUZZ -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -e .php,.html,.txt
```

```bash

[Status: 200, Size: 1323, Words: 188, Lines: 33, Duration: 39ms]
| URL | http://coolpgi.hmv/
    * FUZZ: 

[Status: 200, Size: 944, Words: 146, Lines: 30, Duration: 110ms]
| URL | http://coolpgi.hmv/search
    * FUZZ: search

[Status: 302, Size: 189, Words: 18, Lines: 6, Duration: 112ms]
| URL | http://coolpgi.hmv/login
| --> | /
    * FUZZ: login
```
Three ednpoints are discovered:

- `/login`  - Login functionality (already known)
- `/search` - Result page
- `/panel`  - User Lookup(Interesing)

#### Source code review

```markdown
curl -s -X GET "http://coolpgi.hmv/panel"

<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>CoolPG Panel</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#0b1220; color:#e5e7eb; }
    .wrap { max-width: 720px; margin: 60px auto; padding: 24px; background:#111827; border:1px solid #243044; border-radius:12px; }
    h2 { margin: 0 0 10px 0; }
    .hint { color:#94a3b8; font-size: 13px; margin-bottom: 16px; line-height: 1.4; }
    input { width:100%; padding:10px; margin:8px 0; border-radius:10px; border:1px solid #243044; background:#0b1220; color:#e5e7eb; }
    button { padding:10px 14px; border-radius:10px; border:0; background:#3b82f6; color:white; font-weight:600; cursor:pointer; }
    .muted { color:#64748b; }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Dev note: access control handled upstream -->
    <h2>User Lookup</h2>
    <div class="hint">
      Search users by username.<br>
      <span class="muted">Dev note: UNION reporting is supported for ops audits.</span>
    </div>

    <!-- TODO: sanitize UNION reports before external exposure -->
    <form method="GET" action="/search">
      <input name="q" placeholder="search (e.g. cool)" autocomplete="off">
      <button type="submit">Search</button>
    </form>
  </div>
</body>
</html>
```
Critical notes by Dev :

- Dev note: access control handled upstream.
- Dev note: UNION reporting is supported for ops audits.
- TODO: sanitize UNION reports before external exposure. 

> The source code in `/panel` contains developer comments about "UNION reporting" confirming the possibility of SQL Injection.

## Vulnerability Analysis

